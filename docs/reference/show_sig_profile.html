<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Show Signature Profile — show_sig_profile • sigminer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Show Signature Profile — show_sig_profile" />
<meta property="og:description" content="Who don't like to show a barplot for signature profile? This is for it." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sigminer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ShixiangWang/sigminer/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Show Signature Profile</h1>
    <small class="dont-index">Source: <a href='https://github.com/ShixiangWang/sigminer/blob/master/R/show_sig_profile.R'><code>R/show_sig_profile.R</code></a></small>
    <div class="hidden name"><code>show_sig_profile.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Who don't like to show a barplot for signature profile? This is for it.</p>
    </div>

    <pre class="usage"><span class='fu'>show_sig_profile</span><span class='op'>(</span>
  <span class='va'>Signature</span>,
  mode <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SBS"</span>, <span class='st'>"copynumber"</span>, <span class='st'>"DBS"</span>, <span class='st'>"ID"</span>, <span class='st'>"RS"</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"Wang"</span>,
  by_context <span class='op'>=</span> <span class='cn'>FALSE</span>,
  normalize <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"row"</span>, <span class='st'>"column"</span>, <span class='st'>"raw"</span>, <span class='st'>"feature"</span><span class='op'>)</span>,
  y_tr <span class='op'>=</span> <span class='cn'>NULL</span>,
  filters <span class='op'>=</span> <span class='cn'>NULL</span>,
  feature_setting <span class='op'>=</span> <span class='fu'>sigminer</span><span class='fu'>::</span><span class='va'><a href='CN.features.html'>CN.features</a></span>,
  style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"default"</span>, <span class='st'>"cosmic"</span><span class='op'>)</span>,
  palette <span class='op'>=</span> <span class='fu'><a href='use_color_style.html'>use_color_style</a></span><span class='op'>(</span><span class='va'>style</span>, <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>by_context</span>, <span class='st'>"SBS"</span>, <span class='va'>mode</span><span class='op'>)</span>, <span class='va'>method</span><span class='op'>)</span>,
  set_gradient_color <span class='op'>=</span> <span class='cn'>FALSE</span>,
  free_space <span class='op'>=</span> <span class='st'>"free_x"</span>,
  rm_panel_border <span class='op'>=</span> <span class='va'>style</span> <span class='op'>==</span> <span class='st'>"cosmic"</span>,
  rm_grid_line <span class='op'>=</span> <span class='va'>style</span> <span class='op'>==</span> <span class='st'>"cosmic"</span>,
  rm_axis_text <span class='op'>=</span> <span class='cn'>FALSE</span>,
  bar_border_color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>style</span> <span class='op'>==</span> <span class='st'>"default"</span>, <span class='st'>"grey50"</span>, <span class='st'>"white"</span><span class='op'>)</span>,
  bar_width <span class='op'>=</span> <span class='fl'>0.7</span>,
  paint_axis_text <span class='op'>=</span> <span class='cn'>TRUE</span>,
  x_label_angle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>mode</span> <span class='op'>==</span> <span class='st'>"copynumber"</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/startsWith.html'>startsWith</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='st'>"T"</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>method</span> <span class='op'>==</span>
    <span class='st'>"X"</span><span class='op'>)</span>, <span class='fl'>60</span>, <span class='fl'>90</span><span class='op'>)</span>,
  x_label_vjust <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>mode</span> <span class='op'>==</span> <span class='st'>"copynumber"</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/startsWith.html'>startsWith</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='st'>"T"</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>method</span> <span class='op'>==</span>
    <span class='st'>"X"</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span><span class='op'>)</span>,
  x_label_hjust <span class='op'>=</span> <span class='fl'>1</span>,
  x_lab <span class='op'>=</span> <span class='st'>"Components"</span>,
  y_lab <span class='op'>=</span> <span class='st'>"auto"</span>,
  params <span class='op'>=</span> <span class='cn'>NULL</span>,
  show_cv <span class='op'>=</span> <span class='cn'>FALSE</span>,
  params_label_size <span class='op'>=</span> <span class='fl'>3</span>,
  params_label_angle <span class='op'>=</span> <span class='fl'>60</span>,
  y_expand <span class='op'>=</span> <span class='fl'>1</span>,
  digits <span class='op'>=</span> <span class='fl'>2</span>,
  base_size <span class='op'>=</span> <span class='fl'>12</span>,
  font_scale <span class='op'>=</span> <span class='fl'>1</span>,
  sig_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  sig_orders <span class='op'>=</span> <span class='cn'>NULL</span>,
  check_sig_names <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Signature</th>
      <td><p>a <code>Signature</code> object obtained either from <a href='sig_extract.html'>sig_extract</a> or <a href='sig_auto_extract.html'>sig_auto_extract</a>,
or just a raw signature matrix with row representing components (motifs) and column
representing signatures (column names must start with 'Sig').</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>signature type for plotting, now supports 'copynumber', 'SBS',
'DBS', 'ID' and 'RS' (genome rearrangement signature).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method for copy number feature classification in <a href='sig_tally.html'>sig_tally</a>,
can be one of "Wang" ("W"), "S".</p></td>
    </tr>
    <tr>
      <th>by_context</th>
      <td><p>for specific use.</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>one of 'row', 'column', 'raw' and "feature", for row normalization (signature),
column normalization (component), raw data, row normalization by feature, respectively.
Of note, 'feature' only works when the mode is 'copynumber'.</p></td>
    </tr>
    <tr>
      <th>y_tr</th>
      <td><p>a function (e.g. <code>log10</code>) to transform y axis before plotting.</p></td>
    </tr>
    <tr>
      <th>filters</th>
      <td><p>a pattern used to select components to plot.</p></td>
    </tr>
    <tr>
      <th>feature_setting</th>
      <td><p>a <code>data.frame</code> used for classification.
<strong>Only used when method is "Wang" ("W")</strong>.
Default is <a href='CN.features.html'>CN.features</a>. Users can also set custom input with "feature",
"min" and "max" columns available. Valid features can be printed by
<code><a href='https://rdrr.io/r/base/unique.html'>unique(CN.features$feature)</a></code>.</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p>plot style, one of 'default' and 'cosmic', works when
parameter <code>set_gradient_color</code> is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>palette</th>
      <td><p>palette used to plot when <code>set_gradient_color</code> is <code>FALSE</code>,
default use a built-in palette according to parameter <code>style</code>.</p></td>
    </tr>
    <tr>
      <th>set_gradient_color</th>
      <td><p>default is <code>FALSE</code>, if <code>TRUE</code>, use gradient colors
to fill bars.</p></td>
    </tr>
    <tr>
      <th>free_space</th>
      <td><p>default is 'free_x'. If "fixed", all panels have the same size.
If "free_y" their height will be proportional to the length of the y scale;
if "free_x" their width will be proportional to the length of the x scale;
or if "free" both height and width will vary.
This setting has no effect unless the appropriate scales also vary.</p></td>
    </tr>
    <tr>
      <th>rm_panel_border</th>
      <td><p>default is <code>TRUE</code> for style 'cosmic',
remove panel border to keep plot tight.</p></td>
    </tr>
    <tr>
      <th>rm_grid_line</th>
      <td><p>default is <code>FALSE</code>, if <code>TRUE</code>, remove grid lines of plot.</p></td>
    </tr>
    <tr>
      <th>rm_axis_text</th>
      <td><p>default is <code>FALSE</code>, if <code>TRUE</code>, remove component texts.
This is useful when multiple signature profiles are plotted together.</p></td>
    </tr>
    <tr>
      <th>bar_border_color</th>
      <td><p>the color of bar border.</p></td>
    </tr>
    <tr>
      <th>bar_width</th>
      <td><p>bar width. By default, set to 70% of the resolution of the
data.</p></td>
    </tr>
    <tr>
      <th>paint_axis_text</th>
      <td><p>if <code>TRUE</code>, color on text of x axis.</p></td>
    </tr>
    <tr>
      <th>x_label_angle</th>
      <td><p>font angle for x label.</p></td>
    </tr>
    <tr>
      <th>x_label_vjust</th>
      <td><p>font vjust for x label.</p></td>
    </tr>
    <tr>
      <th>x_label_hjust</th>
      <td><p>font hjust for x label.</p></td>
    </tr>
    <tr>
      <th>x_lab</th>
      <td><p>x axis lab.</p></td>
    </tr>
    <tr>
      <th>y_lab</th>
      <td><p>y axis lab.</p></td>
    </tr>
    <tr>
      <th>params</th>
      <td><p>params <code>data.frame</code> of components, obtained from <a href='sig_tally.html'>sig_tally</a>.</p></td>
    </tr>
    <tr>
      <th>show_cv</th>
      <td><p>default is <code>FALSE</code>, if <code>TRUE</code>, show coefficient of variation when
<code>params</code> is not <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>params_label_size</th>
      <td><p>font size for params label.</p></td>
    </tr>
    <tr>
      <th>params_label_angle</th>
      <td><p>font angle for params label.</p></td>
    </tr>
    <tr>
      <th>y_expand</th>
      <td><p>y expand height for plotting params of copy number signatures.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>digits for plotting params of copy number signatures.</p></td>
    </tr>
    <tr>
      <th>base_size</th>
      <td><p>overall font size.</p></td>
    </tr>
    <tr>
      <th>font_scale</th>
      <td><p>a number used to set font scale.</p></td>
    </tr>
    <tr>
      <th>sig_names</th>
      <td><p>subset signatures or set name of signatures, can be a character vector.
Default is <code>NULL</code>, prefix 'Sig' plus number is used.</p></td>
    </tr>
    <tr>
      <th>sig_orders</th>
      <td><p>set order of signatures, can be a character vector.
Default is <code>NULL</code>, the signatures are ordered by alphabetical order.
If an integer vector set, only specified signatures are plotted.</p></td>
    </tr>
    <tr>
      <th>check_sig_names</th>
      <td><p>if <code>TRUE</code>, check signature names when input is
a matrix, i.e., all signatures (colnames) must start with 'Sig'.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>ggplot</code> object</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='show_sig_profile_loop.html'>show_sig_profile_loop</a>, <a href='show_sig_profile_heatmap.html'>show_sig_profile_heatmap</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Shixiang Wang</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># Load SBS signature</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"toy_mutational_signature.RData"</span>,
  package <span class='op'>=</span> <span class='st'>"sigminer"</span>, mustWork <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span><span class='op'>)</span>
<span class='co'># Show signature profile</span>
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'>show_sig_profile</span><span class='op'>(</span><span class='va'>sig2</span>, mode <span class='op'>=</span> <span class='st'>"SBS"</span><span class='op'>)</span>
<span class='va'>p1</span>

<span class='co'># Use 'y_tr' option to transform values in y axis</span>
<span class='va'>p11</span> <span class='op'>&lt;-</span> <span class='fu'>show_sig_profile</span><span class='op'>(</span><span class='va'>sig2</span>, mode <span class='op'>=</span> <span class='st'>"SBS"</span>, y_tr <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span> <span class='op'>*</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>p11</span>

<span class='co'># Load copy number signature from method "W"</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"toy_copynumber_signature_by_W.RData"</span>,
  package <span class='op'>=</span> <span class='st'>"sigminer"</span>, mustWork <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span><span class='op'>)</span>
<span class='co'># Show signature profile</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'>show_sig_profile</span><span class='op'>(</span><span class='va'>sig</span>,
  style <span class='op'>=</span> <span class='st'>"cosmic"</span>,
  mode <span class='op'>=</span> <span class='st'>"copynumber"</span>,
  method <span class='op'>=</span> <span class='st'>"W"</span>,
  normalize <span class='op'>=</span> <span class='st'>"feature"</span>
<span class='op'>)</span>
<span class='va'>p2</span>

<span class='co'># Visualize rearrangement signatures</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_sig_db.html'>get_sig_db</a></span><span class='op'>(</span><span class='st'>"RS_Nik_lab"</span><span class='op'>)</span>
<span class='va'>ss</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>db</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ss</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sig1"</span>, <span class='st'>"Sig2"</span>, <span class='st'>"Sig3"</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'>show_sig_profile</span><span class='op'>(</span><span class='va'>ss</span>, mode <span class='op'>=</span> <span class='st'>"RS"</span>, style <span class='op'>=</span> <span class='st'>"cosmic"</span><span class='op'>)</span>
<span class='va'>p3</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://orcid.org/0000-0001-9855-7357'>Shixiang Wang</a>, Ziyu Tao, Huimin Li, Tao Wu, <a href='https://orcid.org/0000-0002-7736-0077'>Xue-Song Liu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


