<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyze Copy Number Signatures with sigminer • sigminer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyze Copy Number Signatures with sigminer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/sigminer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cnsignature.html">Analyze Copy Number Signatures with sigminer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ShixiangWang/sigminer/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyze Copy Number Signatures with
sigminer</h1>
                        <h4 data-toc-skip class="author">Shixiang Wang (
<a href="mailto:wangsx1@sysucc.org.cn" class="email">wangsx1@sysucc.org.cn</a> )</h4>
            
            <h4 data-toc-skip class="date">2025-11-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ShixiangWang/sigminer/blob/master/vignettes/cnsignature.Rmd" class="external-link"><code>vignettes/cnsignature.Rmd</code></a></small>
      <div class="hidden name"><code>cnsignature.Rmd</code></div>

    </div>

    
    
<blockquote>
<p>Exploring copy number signatures with recently developed approach
have been described at <a href="https://xsliulab.github.io/Pan-cancer_CNA_signature/" class="external-link">The
repertoire of copy number alteration signatures in human cancer</a>.</p>
<p>A more general introduction please read <a href="https://shixiangwang.github.io/sigminer-book/index.html">Extract,
Analyze and Visualize Mutational Signatures with Sigminer</a>.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ShixiangWang/sigminer" class="external-link">sigminer</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'sigminer':</span></span>
<span><span class="co">#&gt;   method      from</span></span>
<span><span class="co">#&gt;   print.bytes Rcpp</span></span>
<span><span class="co">#&gt; sigminer version 2.3.2</span></span>
<span><span class="co">#&gt; - Star me at https://github.com/ShixiangWang/sigminer</span></span>
<span><span class="co">#&gt; - Run hello() to see usage and citation.</span></span></code></pre></div>
<p>For this analysis, data with six columns are required.</p>
<ul>
<li>Chromosome</li>
<li>Start.bp</li>
<li>End.bp</li>
<li>modal_cn (i.e. total copy number, integer)</li>
<li>minor_cn (i.e. copy number for minor allele, integer)</li>
<li>sample</li>
</ul>
<div class="section level2">
<h2 id="generate-allele-specific-copy-number-profile">Generate allele-specific copy number profile<a class="anchor" aria-label="anchor" href="#generate-allele-specific-copy-number-profile"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://henrikbengtsson.github.io/R.oo/reference/Non-documented_objects.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"toy_segTab.RData"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"sigminer"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">segTabs</span><span class="op">$</span><span class="va">minor_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">segTabs</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_copynumber.html">read_copynumber</a></span><span class="op">(</span><span class="va">segTabs</span>,</span>
<span>  seg_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chromosome"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"segVal"</span><span class="op">)</span>,</span>
<span>  genome_measure <span class="op">=</span> <span class="st">"wg"</span>, complement <span class="op">=</span> <span class="cn">TRUE</span>, add_loh <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.628728]: </span><span style="color: #0000BB; font-weight: bold;">Started.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.639861]: </span><span style="color: #0000BB; font-weight: bold;">Genome build  : hg19.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.641564]: </span><span style="color: #0000BB; font-weight: bold;">Genome measure: wg.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.643273]: </span><span style="color: #0000BB; font-weight: bold;">When add_loh is TRUE, use_all is forced to TRUE.</span></span></span>
<span><span class="co"><span style="color: #0000BB; font-weight: bold;">#&gt; Please drop columns you don't want to keep before reading.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.654636]: </span><span style="color: #00BB00; font-weight: bold;">Chromosome size database for build obtained.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.656434]: </span><span style="color: #0000BB; font-weight: bold;">Reading input.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.658159]: </span><span style="color: #00BB00; font-weight: bold;">A data frame as input detected.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.660169]: </span><span style="color: #00BB00; font-weight: bold;">Column names checked.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.662274]: </span><span style="color: #00BB00; font-weight: bold;">Column order set.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.670262]: </span><span style="color: #00BB00; font-weight: bold;">Chromosomes unified.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.687523]: </span><span style="color: #00BB00; font-weight: bold;">Value 2 (normal copy) filled to uncalled chromosomes.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.692398]: </span><span style="color: #00BB00; font-weight: bold;">Data imported.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.694181]: </span><span style="color: #0000BB; font-weight: bold;">Segments info:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.695909]: </span><span style="color: #0000BB; font-weight: bold;">    Keep - 477</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.703314]: </span><span style="color: #0000BB; font-weight: bold;">    Drop - 0</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.705386]: </span><span style="color: #00BB00; font-weight: bold;">Segments sorted.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.707027]: </span><span style="color: #0000BB; font-weight: bold;">Adding LOH labels...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.709489]: </span><span style="color: #0000BB; font-weight: bold;">Joining adjacent segments with same copy number value. Be patient...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.882066]: </span><span style="color: #00BB00; font-weight: bold;">410 segments left after joining.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.884385]: </span><span style="color: #00BB00; font-weight: bold;">Segmental table cleaned.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.886539]: </span><span style="color: #0000BB; font-weight: bold;">Annotating.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.902185]: </span><span style="color: #00BB00; font-weight: bold;">Annotation done.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.903946]: </span><span style="color: #0000BB; font-weight: bold;">Summarizing per sample.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.925171]: </span><span style="color: #00BB00; font-weight: bold;">Summarized.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.926917]: </span><span style="color: #0000BB; font-weight: bold;">Generating CopyNumber object.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.929168]: </span><span style="color: #00BB00; font-weight: bold;">Generated.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.93085]: </span><span style="color: #0000BB; font-weight: bold;">Validating object.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.932585]: </span><span style="color: #00BB00; font-weight: bold;">Done.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:07.934539]: </span><span style="color: #0000BB; font-weight: bold;">0.306 secs elapsed.</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn</span></span>
<span><span class="co">#&gt; An object of class CopyNumber </span></span>
<span><span class="co">#&gt; =============================</span></span>
<span><span class="co">#&gt;                           sample n_of_seg n_of_cnv n_of_amp n_of_del n_of_vchr</span></span>
<span><span class="co">#&gt;                           &lt;char&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1: TCGA-DF-A2KN-01A-11D-A17U-01       34        6        5        1         4</span></span>
<span><span class="co">#&gt;  2: TCGA-19-2621-01B-01D-0911-01       34        8        5        3         5</span></span>
<span><span class="co">#&gt;  3: TCGA-B6-A0X5-01A-21D-A107-01       29        8        4        4         2</span></span>
<span><span class="co">#&gt;  4: TCGA-A8-A07S-01A-11D-A036-01       39       11        2        9         4</span></span>
<span><span class="co">#&gt;  5: TCGA-26-6174-01A-21D-1842-01       44       13        8        5         8</span></span>
<span><span class="co">#&gt;  6: TCGA-CV-7432-01A-11D-2128-01       41       16        7        9         9</span></span>
<span><span class="co">#&gt;  7: TCGA-06-0644-01A-02D-0310-01       47       19        5       14         8</span></span>
<span><span class="co">#&gt;  8: TCGA-A5-A0G2-01A-11D-A042-01       40       21        5       16        10</span></span>
<span><span class="co">#&gt;  9: TCGA-99-7458-01A-11D-2035-01       49       26       10       16        13</span></span>
<span><span class="co">#&gt; 10: TCGA-05-4417-01A-22D-1854-01       53       37       33        4        17</span></span>
<span><span class="co">#&gt;     n_loh cna_burden</span></span>
<span><span class="co">#&gt;     &lt;int&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:    15      0.000</span></span>
<span><span class="co">#&gt;  2:    20      0.095</span></span>
<span><span class="co">#&gt;  3:    18      0.083</span></span>
<span><span class="co">#&gt;  4:    21      0.106</span></span>
<span><span class="co">#&gt;  5:    24      0.113</span></span>
<span><span class="co">#&gt;  6:    24      0.188</span></span>
<span><span class="co">#&gt;  7:    33      0.158</span></span>
<span><span class="co">#&gt;  8:    23      0.375</span></span>
<span><span class="co">#&gt;  9:    33      0.304</span></span>
<span><span class="co">#&gt; 10:    29      0.617</span></span>
<span><span class="va">cn</span><span class="op">@</span><span class="va">data</span></span>
<span><span class="co">#&gt;      chromosome     start       end segVal                       sample</span></span>
<span><span class="co">#&gt;          &lt;char&gt;     &lt;num&gt;     &lt;num&gt;  &lt;int&gt;                       &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1:       chr1   3218923 116319008      2 TCGA-05-4417-01A-22D-1854-01</span></span>
<span><span class="co">#&gt;   2:       chr1 116324707 120523902      1 TCGA-05-4417-01A-22D-1854-01</span></span>
<span><span class="co">#&gt;   3:       chr1 149879545 247812431      4 TCGA-05-4417-01A-22D-1854-01</span></span>
<span><span class="co">#&gt;   4:      chr10    423671 135224372      3 TCGA-05-4417-01A-22D-1854-01</span></span>
<span><span class="co">#&gt;   5:      chr11    458784  19461653      3 TCGA-05-4417-01A-22D-1854-01</span></span>
<span><span class="co">#&gt;  ---                                                                   </span></span>
<span><span class="co">#&gt; 406:       chr6   1016984 170898549      2 TCGA-DF-A2KN-01A-11D-A17U-01</span></span>
<span><span class="co">#&gt; 407:       chr7    746917 158385118      2 TCGA-DF-A2KN-01A-11D-A17U-01</span></span>
<span><span class="co">#&gt; 408:       chr8    617885 145225107      2 TCGA-DF-A2KN-01A-11D-A17U-01</span></span>
<span><span class="co">#&gt; 409:       chr9    790234 140938075      2 TCGA-DF-A2KN-01A-11D-A17U-01</span></span>
<span><span class="co">#&gt; 410:       chrX         1 155270560      2 TCGA-DF-A2KN-01A-11D-A17U-01</span></span>
<span><span class="co">#&gt;       minor_cn    loh .loh_frac</span></span>
<span><span class="co">#&gt;          &lt;num&gt; &lt;lgcl&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1: 1.0000000  FALSE        NA</span></span>
<span><span class="co">#&gt;   2: 0.0000000   TRUE        NA</span></span>
<span><span class="co">#&gt;   3: 0.5000000   TRUE 0.1175943</span></span>
<span><span class="co">#&gt;   4: 1.0000000  FALSE        NA</span></span>
<span><span class="co">#&gt;   5: 1.0000000  FALSE        NA</span></span>
<span><span class="co">#&gt;  ---                           </span></span>
<span><span class="co">#&gt; 406: 0.3333333   TRUE 0.9979494</span></span>
<span><span class="co">#&gt; 407: 1.0000000  FALSE        NA</span></span>
<span><span class="co">#&gt; 408: 1.0000000  FALSE        NA</span></span>
<span><span class="co">#&gt; 409: 0.5000000   TRUE 0.8328715</span></span>
<span><span class="co">#&gt; 410:        NA  FALSE        NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="classify-the-segments-with-steele-et-al-method">Classify the segments with Steele et al method<a class="anchor" aria-label="anchor" href="#classify-the-segments-with-steele-et-al-method"></a>
</h2>
<blockquote>
<p>If you want to try other type of copy number signatures, change the
method argument.</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tally_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig_tally.html">sig_tally</a></span><span class="op">(</span><span class="va">cn</span>, method <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:08.082316]: </span><span style="color: #0000BB; font-weight: bold;">Started.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:08.086812]: </span><span style="color: #0000BB; font-weight: bold;">When you use method 'S', please make sure you have set 'join_adj_seg' to FALSE and 'add_loh' to TRUE in 'read_copynumber() in the previous step!</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:08.101282]: </span><span style="color: #00BB00; font-weight: bold;">Matrix generated.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:08.103231]: </span><span style="color: #0000BB; font-weight: bold;">0.021 secs elapsed.</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tally_s</span><span class="op">$</span><span class="va">all_matrices</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ CN_40: int [1:10, 1:40] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;  $ CN_48: int [1:10, 1:48] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="find-de-novo-signatures">Find de novo signatures<a class="anchor" aria-label="anchor" href="#find-de-novo-signatures"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sig_denovo</span> <span class="op">=</span> <span class="fu"><a href="../reference/sig_auto_extract.html">sig_auto_extract</a></span><span class="op">(</span><span class="va">tally_s</span><span class="op">$</span><span class="va">all_matrices</span><span class="op">$</span><span class="va">CN_48</span><span class="op">)</span></span>
<span><span class="co">#&gt; Select Run 3, which K = 2 as best solution.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sig_denovo</span><span class="op">$</span><span class="va">Signature</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         Sig1          Sig2</span></span>
<span><span class="co">#&gt; 0:homdel:0-100Kb    0.000000  0.000000e+00</span></span>
<span><span class="co">#&gt; 0:homdel:100Kb-1Mb  0.000000  0.000000e+00</span></span>
<span><span class="co">#&gt; 0:homdel:&gt;1Mb       0.000000  0.000000e+00</span></span>
<span><span class="co">#&gt; 1:LOH:0-100Kb       3.609460 3.819129e-242</span></span>
<span><span class="co">#&gt; 1:LOH:100Kb-1Mb     6.316554 2.814800e-127</span></span>
<span><span class="co">#&gt; 1:LOH:1Mb-10Mb     13.535473 2.784288e-190</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="refit-19-reference-signatures">Refit (19) reference signatures<a class="anchor" aria-label="anchor" href="#refit-19-reference-signatures"></a>
</h2>
<p>This directly calculates the contribution of 19 reference
signatures.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">act_refit</span> <span class="op">=</span> <span class="fu"><a href="../reference/sig_fit.html">sig_fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">tally_s</span><span class="op">$</span><span class="va">all_matrices</span><span class="op">$</span><span class="va">CN_48</span><span class="op">)</span>, sig_index <span class="op">=</span> <span class="st">"ALL"</span>, sig_db <span class="op">=</span> <span class="st">"CNS_TCGA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.015874]: </span><span style="color: #0000BB; font-weight: bold;">Started.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.017781]: </span><span style="color: #00BB00; font-weight: bold;">Signature index detected.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.019398]: </span><span style="color: #0000BB; font-weight: bold;">Checking signature database in package.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.021903]: </span><span style="color: #0000BB; font-weight: bold;">Checking signature index.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.023569]: </span><span style="color: #0000BB; font-weight: bold;">Valid index for db 'CNS_TCGA':</span></span></span>
<span><span class="co"><span style="color: #0000BB; font-weight: bold;">#&gt; CN1 CN2 CN3 CN4 CN5 CN6 CN7 CN8 CN9 CN10 CN11 CN12 CN13 CN14 CN15 CN16 CN17 CN18 CN19</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.025265]: </span><span style="color: #00BB00; font-weight: bold;">Database and index checked.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.027086]: </span><span style="color: #00BB00; font-weight: bold;">Signature normalized.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.02867]: </span><span style="color: #0000BB; font-weight: bold;">Checking row number for catalog matrix and signature matrix.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.030265]: </span><span style="color: #00BB00; font-weight: bold;">Checked.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.031844]: </span><span style="color: #0000BB; font-weight: bold;">Checking rownames for catalog matrix and signature matrix.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.03343]: </span><span style="color: #00BB00; font-weight: bold;">Checked.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.034999]: </span><span style="color: #00BB00; font-weight: bold;">Method 'QP' detected.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.038659]: </span><span style="color: #00BB00; font-weight: bold;">Corresponding function generated.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.040371]: </span><span style="color: #0000BB; font-weight: bold;">Calling function.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.042412]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-05-4417-01A-22D-1854-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.044338]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-06-0644-01A-02D-0310-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.046078]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-19-2621-01B-01D-0911-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.047802]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-26-6174-01A-21D-1842-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.049505]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-99-7458-01A-11D-2035-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.051218]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-A5-A0G2-01A-11D-A042-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.052936]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-A8-A07S-01A-11D-A036-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.054666]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-B6-A0X5-01A-21D-A107-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.056413]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-CV-7432-01A-11D-2128-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.058149]: </span><span style="color: #0000BB; font-weight: bold;">Fitting sample: TCGA-DF-A2KN-01A-11D-A17U-01</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.05985]: </span><span style="color: #00BB00; font-weight: bold;">Done.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.061504]: </span><span style="color: #0000BB; font-weight: bold;">Generating output signature exposures.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.063872]: </span><span style="color: #00BB00; font-weight: bold;">Done.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="font-weight: bold;">[2025-11-30 14:32:09.065664]: </span><span style="color: #0000BB; font-weight: bold;">0.05 secs elapsed.</span></span></span></code></pre></div>
<p>We can use some threshold to keep really contributed signautres.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">act_refit2</span> <span class="op">=</span> <span class="va">act_refit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">act_refit</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">act_refit2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "CN1"  "CN2"  "CN3"  "CN4"  "CN9"  "CN11" "CN12" "CN13" "CN14" "CN19"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-signatures">Plot signatures<a class="anchor" aria-label="anchor" href="#plot-signatures"></a>
</h2>
<p>For de novo signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_sig_profile.html">show_sig_profile</a></span><span class="op">(</span><span class="va">sig_denovo</span>, mode <span class="op">=</span> <span class="st">"copynumber"</span>, method <span class="op">=</span> <span class="st">"S"</span>, style <span class="op">=</span> <span class="st">"cosmic"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">sigminer</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/ShixiangWang/sigminer/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">sigminer</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/ShixiangWang/sigminer/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="cnsignature_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="960"></p>
<p>Show the activity/exposure.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">sig_denovo</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnsignature_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="700"></p>
<p>For reference signatures, you can just select what you want:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_sig_profile.html">show_sig_profile</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/get_sig_db.html">get_sig_db</a></span><span class="op">(</span><span class="st">"CNS_TCGA"</span><span class="op">)</span><span class="op">$</span><span class="va">db</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">act_refit2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"cosmic"</span>, </span>
<span>  mode <span class="op">=</span> <span class="st">"copynumber"</span>, method <span class="op">=</span> <span class="st">"S"</span>, check_sig_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnsignature_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="960"></p>
<p>Similarly for showing activity.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">act_refit2</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnsignature_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" width="700"></p>
<p>NOTE that this case shows relatively large difference with different
approaches, so you need to pick based on your data size/quality and
double-check the results. In general, for small-size data set, the
refitting approach is recommended.</p>
</div>
<div class="section level2">
<h2 id="signature-assignment">Signature assignment<a class="anchor" aria-label="anchor" href="#signature-assignment"></a>
</h2>
<p>To assign the de-novo signatures to reference signatures, we use
cosine similarity.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_sig_similarity.html">get_sig_similarity</a></span><span class="op">(</span><span class="va">sig_denovo</span>, sig_db <span class="op">=</span> <span class="st">"CNS_TCGA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; -Comparing against COSMIC signatures</span></span>
<span><span class="co">#&gt; ------------------------------------</span></span>
<span><span class="co">#&gt; --Found Sig1 most similar to CN1</span></span>
<span><span class="co">#&gt;    Aetiology: See https://cancer.sanger.ac.uk/signatures/cn/ [similarity: 0.706]</span></span>
<span><span class="co">#&gt; --Found Sig2 most similar to CN2</span></span>
<span><span class="co">#&gt;    Aetiology: See https://cancer.sanger.ac.uk/signatures/cn/ [similarity: 0.771]</span></span>
<span><span class="co">#&gt; ------------------------------------</span></span>
<span><span class="co">#&gt; Return result invisiblely.</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://orcid.org/0000-0001-9855-7357" class="external-link">Shixiang Wang</a>, Ziyu Tao, Huimin Li, Tao Wu, <a href="https://orcid.org/0000-0002-7736-0077" class="external-link">Xue-Song Liu</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
