<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Score Copy Number Profile — scoring • sigminer</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Score Copy Number Profile — scoring"><meta property="og:description" content="Returns quantification of copy number profile and events including
tandem duplication and Chromothripisis etc.
Only copy number data from autosome is used here.
Some of the quantification methods are rough,
you use at your risk. You should do some extra work to check the
result scores."><meta property="og:image" content="https://shixiangwang.github.io/sigminer/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sigminer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cnsignature.html">Analyze Copy Number Signatures with sigminer</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ShixiangWang/sigminer/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score Copy Number Profile</h1>
    <small class="dont-index">Source: <a href="https://github.com/ShixiangWang/sigminer/blob/HEAD/R/scoring.R" class="external-link"><code>R/scoring.R</code></a></small>
    <div class="hidden name"><code>scoring.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns quantification of copy number profile and events including
tandem duplication and Chromothripisis etc.
Only copy number data from autosome is used here.
<strong>Some of the quantification methods are rough,
you use at your risk</strong>. You should do some extra work to check the
result scores.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scoring</span><span class="op">(</span><span class="va">object</span>, TD_size_cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100000</span>, <span class="fl">2000000</span><span class="op">)</span>, TD_cn_cutoff <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a object of <a href="CopyNumber-class.html">CopyNumber</a>.</p></dd>


<dt>TD_size_cutoff</dt>
<dd><p>a length-3 numeric vector used to specify the start, midpoint, end
segment size for determining tandem duplication size range, midpoint is used to split
TD into short TD and long TD. Default is 1Kb to 100Kb for short TD, 100Kb to 2Mb for long
TD.</p></dd>


<dt>TD_cn_cutoff</dt>
<dd><p>a number defining the maximum copy number of TD,
default is <code>Inf</code>, i.e. no cutoff.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>data.table</code> with following scores:</p><ul><li><p>cnaBurden: CNA burden representing the altered genomic fraction as previously reported.</p></li>
<li><p>cnaLoad: CNA load representing the quantity of copy number alteration.</p></li>
<li><p>MACN: mean altered copy number (MACN) reflecting the property of altered copy number segments,
calculated as
$$MACN = \frac{\sum_{i} CN_i}{N_{cnv}}$$
where \(CN_i\) is the copy number of altered segment \(i\), \(N_{cnv}\) is
the number of CNV.</p></li>
<li><p>weightedMACN: same as MACN but weighted with segment length.
$$MACN_{weighted} = \frac{\sum_{i} (CN_i \times L_{i})}{ \sum_{i} L_{i} }$$
where \(L_{i}\) is the length of altered copy number segment \(i\).</p></li>
<li><p>Ploidy: ploidy, the formula is same as <code>weightedMACN</code> but using all copy number segments instead of
altered copy number segments.</p></li>
<li><p>TDP_pnas: tandem duplication phenotype score from <code>https://www.pnas.org/doi/10.1073/pnas.1520010113</code>,
the threshold <code>k</code> in reference is omitted.
$$TDP = - \frac{\sum_{chr} |TD_{obs}-TD_{exp}|}{TD_{total}}$$
where \(TD_{total}\) is the number of TD, \(TD_{obs}\) and
\(TD_exp\) are observed number of TD and expected number of TD for each chromosome.</p></li>
<li><p>TDP: tandem duplication score used defined by our group work,
TD represents segment with copy number greater than 2.
$$TD = \frac{TD_{total}}{\sum_{chr} |TD_{obs}-TD_{exp}|+1}$$</p></li>
<li><p>sTDP: TDP score for short TD.</p></li>
<li><p>lTDP: TDP score for long TD.</p></li>
<li><p>TDP_size : TDP region size (Mb).</p></li>
<li><p>sTDP_size: sTDP region size (Mb).</p></li>
<li><p>lTDP_size: lTDP region size(Mb).</p></li>
<li><p>Chromoth_state: chromothripsis state score,
according to reference <a href="https://doi.org/10.1016/j.cell.2013.02.023" class="external-link">doi:10.1016/j.cell.2013.02.023</a>
,
chromothripsis frequently leads to massive loss of segments on
the affected chromosome with segmental losses being interspersed with regions displaying
normal (disomic) copy-number (e.g., copy-number states oscillating between
copy-number = 1 and copy-number = 2), form tens to hundreds of locally clustered DNA rearrangements.
Most of methods use both SV and CNV to infer chromothripsis, here we roughly quantify it with
$$\sum_{chr}{N_{OsCN}^2}$$
where \(N_{OsCN}\) is the number of oscillating copy number pattern "2-1-2" for each chromosome.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load copy number object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/R.oo/man/Non-documented_objects.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"toy_copynumber.RData"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"sigminer"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">scoring</span><span class="op">(</span><span class="va">cn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           sample cnaBurden cnaLoad  MACN weightedMACN Ploidy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           &lt;char&gt;     &lt;num&gt;   &lt;num&gt; &lt;num&gt;        &lt;num&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: TCGA-DF-A2KN-01A-11D-A17U-01     0.000    2.81  2.83         2.98   2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: TCGA-B6-A0X5-01A-21D-A107-01     0.087    3.17  2.00         1.94   1.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: TCGA-19-2621-01B-01D-0911-01     0.099    3.17  4.62         1.10   1.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: TCGA-A8-A07S-01A-11D-A036-01     0.112    3.58  1.45         2.17   2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: TCGA-26-6174-01A-21D-1842-01     0.119    3.81  2.08         2.60   2.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: TCGA-06-0644-01A-02D-0310-01     0.165    4.32  1.47         2.10   2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: TCGA-CV-7432-01A-11D-2128-01     0.198    4.09  2.69         2.02   2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: TCGA-99-7458-01A-11D-2035-01     0.318    4.75  2.27         1.63   1.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: TCGA-A5-A0G2-01A-11D-A042-01     0.393    4.46  1.29         1.62   1.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: TCGA-05-4417-01A-22D-1854-01     0.654    5.25  3.89         3.53   3.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TD_count       TDP      sTDP      lTDP TDP_size sTDP_size lTDP_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        5 0.5188679 0.4313725 0.4647887 0.790283  0.103883  0.686400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        3 0.4459459 0.0000000 0.4459459 1.812822  0.000000  1.812822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        5 0.4954955 0.0000000 0.4954955 4.189389  0.000000  4.189389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        0 0.0000000 0.0000000 0.0000000 0.000000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        6 0.5840708 0.3437500 0.5445545 2.285822  0.095838  2.189984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        1 0.3437500 0.0000000 0.3437500 0.101453  0.000000  0.101453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        1 0.3437500 0.0000000 0.3437500 0.846245  0.000000  0.846245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        6 0.5840708 0.0000000 0.5840708 5.223909  0.000000  5.223909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        1 0.3437500 0.3437500 0.0000000 0.091632  0.091632  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:        2 0.4313725 0.0000000 0.4313725 0.452862  0.000000  0.452862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      TDP_pnas Chromoth_state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: -1.727273              1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: -1.909091              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: -1.818182              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:       NaN             34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: -1.545455              9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: -1.909091             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: -1.909091              7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: -1.545455             10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: -1.909091              6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: -1.818182              0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu">scoring</span><span class="op">(</span><span class="va">cn</span>, TD_cn_cutoff <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           sample cnaBurden cnaLoad  MACN weightedMACN Ploidy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           &lt;char&gt;     &lt;num&gt;   &lt;num&gt; &lt;num&gt;        &lt;num&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: TCGA-DF-A2KN-01A-11D-A17U-01     0.000    2.81  2.83         2.98   2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: TCGA-B6-A0X5-01A-21D-A107-01     0.087    3.17  2.00         1.94   1.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: TCGA-19-2621-01B-01D-0911-01     0.099    3.17  4.62         1.10   1.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: TCGA-A8-A07S-01A-11D-A036-01     0.112    3.58  1.45         2.17   2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: TCGA-26-6174-01A-21D-1842-01     0.119    3.81  2.08         2.60   2.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: TCGA-06-0644-01A-02D-0310-01     0.165    4.32  1.47         2.10   2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: TCGA-CV-7432-01A-11D-2128-01     0.198    4.09  2.69         2.02   2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: TCGA-99-7458-01A-11D-2035-01     0.318    4.75  2.27         1.63   1.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: TCGA-A5-A0G2-01A-11D-A042-01     0.393    4.46  1.29         1.62   1.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: TCGA-05-4417-01A-22D-1854-01     0.654    5.25  3.89         3.53   3.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TD_count       TDP      sTDP      lTDP TDP_size sTDP_size lTDP_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        5 0.5188679 0.4313725 0.4647887 0.790283  0.103883  0.686400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        3 0.4459459 0.0000000 0.4459459 1.812822  0.000000  1.812822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 0.4647887 0.0000000 0.4647887 2.272032  0.000000  2.272032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        0 0.0000000 0.0000000 0.0000000 0.000000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        6 0.5840708 0.3437500 0.5445545 2.285822  0.095838  2.189984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        1 0.3437500 0.0000000 0.3437500 0.101453  0.000000  0.101453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        1 0.3437500 0.0000000 0.3437500 0.846245  0.000000  0.846245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        4 0.5301205 0.0000000 0.5301205 2.555474  0.000000  2.555474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        1 0.3437500 0.3437500 0.0000000 0.091632  0.091632  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:        0 0.0000000 0.0000000 0.0000000 0.000000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      TDP_pnas Chromoth_state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: -1.727273              1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: -1.909091              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: -1.818182              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:       NaN             34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: -1.545455              9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: -1.909091             13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: -1.909091              7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: -1.636364             10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: -1.909091              6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       NaN              0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://orcid.org/0000-0001-9855-7357" class="external-link">Shixiang Wang</a>, Ziyu Tao, Huimin Li, Tao Wu, <a href="https://orcid.org/0000-0002-7736-0077" class="external-link">Xue-Song Liu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

